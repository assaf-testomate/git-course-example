This is mostafa's code...